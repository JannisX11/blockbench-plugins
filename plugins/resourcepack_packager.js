/* Blockbench "resourcepack_packager" Plugin created by leopoldhub*/

/** This work is licensed under the Creative Commons Attribution 4.0 International License.
To view a copy of this license, visit http://creativecommons.org/licenses/by/4.0/ or send a letter to Creative Commons, PO Box 1866, Mountain View, CA 94042, USA. */

/* the source code is in the "src/resourcepack_packager" folder! */
(()=>{var e={187:e=>{"use strict";var t,r="object"==typeof Reflect?Reflect:null,n=r&&"function"==typeof r.apply?r.apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)};t=r&&"function"==typeof r.ownKeys?r.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var o=Number.isNaN||function(e){return e!=e};function i(){i.init.call(this)}e.exports=i,e.exports.once=function(e,t){return new Promise((function(r,n){function o(r){e.removeListener(t,i),n(r)}function i(){"function"==typeof e.removeListener&&e.removeListener("error",o),r([].slice.call(arguments))}m(e,t,i,{once:!0}),"error"!==t&&function(e,t,r){"function"==typeof e.on&&m(e,"error",t,r)}(e,o,{once:!0})}))},i.EventEmitter=i,i.prototype._events=void 0,i.prototype._eventsCount=0,i.prototype._maxListeners=void 0;var a=10;function s(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function c(e){return void 0===e._maxListeners?i.defaultMaxListeners:e._maxListeners}function u(e,t,r,n){var o,i,a,u;if(s(r),void 0===(i=e._events)?(i=e._events=Object.create(null),e._eventsCount=0):(void 0!==i.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),i=e._events),a=i[t]),void 0===a)a=i[t]=r,++e._eventsCount;else if("function"==typeof a?a=i[t]=n?[r,a]:[a,r]:n?a.unshift(r):a.push(r),(o=c(e))>0&&a.length>o&&!a.warned){a.warned=!0;var l=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");l.name="MaxListenersExceededWarning",l.emitter=e,l.type=t,l.count=a.length,u=l,console&&console.warn&&console.warn(u)}return e}function l(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function f(e,t,r){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},o=l.bind(n);return o.listener=r,n.wrapFn=o,o}function p(e,t,r){var n=e._events;if(void 0===n)return[];var o=n[t];return void 0===o?[]:"function"==typeof o?r?[o.listener||o]:[o]:r?function(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}(o):v(o,o.length)}function d(e){var t=this._events;if(void 0!==t){var r=t[e];if("function"==typeof r)return 1;if(void 0!==r)return r.length}return 0}function v(e,t){for(var r=new Array(t),n=0;n<t;++n)r[n]=e[n];return r}function m(e,t,r,n){if("function"==typeof e.on)n.once?e.once(t,r):e.on(t,r);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function o(i){n.once&&e.removeEventListener(t,o),r(i)}))}}Object.defineProperty(i,"defaultMaxListeners",{enumerable:!0,get:function(){return a},set:function(e){if("number"!=typeof e||e<0||o(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");a=e}}),i.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},i.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||o(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},i.prototype.getMaxListeners=function(){return c(this)},i.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var o="error"===e,i=this._events;if(void 0!==i)o=o&&void 0===i.error;else if(!o)return!1;if(o){var a;if(t.length>0&&(a=t[0]),a instanceof Error)throw a;var s=new Error("Unhandled error."+(a?" ("+a.message+")":""));throw s.context=a,s}var c=i[e];if(void 0===c)return!1;if("function"==typeof c)n(c,this,t);else{var u=c.length,l=v(c,u);for(r=0;r<u;++r)n(l[r],this,t)}return!0},i.prototype.addListener=function(e,t){return u(this,e,t,!1)},i.prototype.on=i.prototype.addListener,i.prototype.prependListener=function(e,t){return u(this,e,t,!0)},i.prototype.once=function(e,t){return s(t),this.on(e,f(this,e,t)),this},i.prototype.prependOnceListener=function(e,t){return s(t),this.prependListener(e,f(this,e,t)),this},i.prototype.removeListener=function(e,t){var r,n,o,i,a;if(s(t),void 0===(n=this._events))return this;if(void 0===(r=n[e]))return this;if(r===t||r.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!=typeof r){for(o=-1,i=r.length-1;i>=0;i--)if(r[i]===t||r[i].listener===t){a=r[i].listener,o=i;break}if(o<0)return this;0===o?r.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(r,o),1===r.length&&(n[e]=r[0]),void 0!==n.removeListener&&this.emit("removeListener",e,a||t)}return this},i.prototype.off=i.prototype.removeListener,i.prototype.removeAllListeners=function(e){var t,r,n;if(void 0===(r=this._events))return this;if(void 0===r.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete r[e]),this;if(0===arguments.length){var o,i=Object.keys(r);for(n=0;n<i.length;++n)"removeListener"!==(o=i[n])&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=r[e]))this.removeListener(e,t);else if(void 0!==t)for(n=t.length-1;n>=0;n--)this.removeListener(e,t[n]);return this},i.prototype.listeners=function(e){return p(this,e,!0)},i.prototype.rawListeners=function(e){return p(this,e,!1)},i.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):d.call(e,t)},i.prototype.listenerCount=d,i.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]}},932:(e,t,r)=>{"use strict";const n=r(504);e.exports=e=>{if(!n(e))return!1;const t=e.trim().match(n.regex),r={};if(t[1]){r.mediaType=t[1].toLowerCase();const e=t[1].split(";").map((e=>e.toLowerCase()));r.contentType=e[0],e.slice(1).forEach((e=>{const t=e.split("=");r[t[0]]=t[1]}))}return r.base64=!!t[t.length-2],r.data=t[t.length-1]||"",r.toBuffer=()=>{const e=r.base64?"base64":"utf8";return Buffer.from(r.data,e)},r}},378:function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function s(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=o(r(418)),a=o(r(87)),s=r(292),c=r(352);class u extends Dialog{constructor(e){super({id:"export-resourcepack-form-dialog",title:"Export resourcepack",form:{resourcepackName:{label:"Resourcepack Name",type:"text",value:e.resourcepackName},resourcepackVersion:{label:"Resourcepack Version",type:"select",options:Object.fromEntries(Object.entries(i.default).map((e=>e.reverse()))),value:e.resourcepackVersion},resourcepackDescription:{label:"Resourcepack Description",type:"textarea",value:e.resourcepackDescription},enableResourcepackCredits:{label:"Enable Credits",type:"checkbox",value:e.enableResourcepackCredits},resourcepackCredits:{label:"Resourcepack Credits",type:"text",value:e.resourcepackCredits},modelType:{label:"Model type",type:"select",options:{block:"block",item:"item"},value:e.modelType},namespace:{label:"Namespace",type:"text",value:e.namespace},modelId:{label:"Model id",type:"text",value:e.modelId},enableAnimation:{label:"Enable Animation",type:"checkbox",value:e.enableAnimation},frameTime:{label:"Time between frames",type:"number",min:1,value:e.frameTime},frameStart:{label:"Starting frame",description:"must be inferior to the number of frames in your animation",type:"number",min:0,value:e.frameStart},interpolate:{label:"Interpolate",description:'generate "between-frames" if frametime > 1',type:"checkbox",value:e.interpolate}},onConfirm:e=>n(this,void 0,void 0,(function*(){const t=e;(0,s.setResourcepackFormDialogOptions)(t),(0,c.saveArchive)(yield(0,a.default)(t),t.resourcepackName)}))})}}t.default=u},751:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(r(308)),i=r(292),a=n(r(378));class s extends Action{constructor(){super("export-resourcepack-menu-action",{name:"Export resourcepack",icon:"fa-file-zipper",click:()=>{this.exportResourcepackFormDialog.show()},condition:()=>"java_block"===Format.id}),this.exportResourcepackFormDialog=new a.default((0,i.getResourcepackFormDialogOptions)()),o.default.once("unload",this.exportResourcepackFormDialog.delete)}}t.default=s},607:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(r(751)),i=n(r(308));i.default.on("load",(()=>{const e=new o.default;MenuBar.addAction(e,"file.export"),i.default.once("unload",(()=>{try{e.delete()}catch(e){}}))})),Plugin.register("resourcepack_packager",{title:"Resourcepack Packager",author:"leopoldhub",description:"Export your java models and texture into a resourcepack",icon:"fa-file-zipper",tags:["Minecraft: Java Edition","Resourcepack","Exporter"],variant:"both",version:"1.0.1",oninstall:()=>{i.default.emit("install")},onload:()=>{i.default.emit("load")},onuninstall:()=>{i.default.emit("uninstall")},onunload:()=>{i.default.emit("unload")}})},418:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={1.8:1,"1.9-1.10":2,"1.11-1.12":3,"1.13-1.14":4,"1.15-1.16.1":5,"1.16.2-1.16.5":6,"1.17.17.1":7,"1.18-1.18.2":8,"1.19-1.19.2":9,"1.19.3":12}},308:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(r(187));t.default=new o.default},87:function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function s(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=o(r(583)),a=r(811),s=r(352);t.default=function(e){return n(this,void 0,void 0,(function*(){const t=new i.default;try{t.file("pack.png",yield(0,a.obtainBase64PackIcon)(),{base64:!0})}catch(e){console.error("unable to add pack icon... reason: ",e)}(0,s.archiveManifest)(t,e.resourcepackDescription,parseInt(e.resourcepackVersion,10));const r=(0,s.getNamespaceTexturesFolder)(t,e.namespace,e.modelType),n=(0,s.getNamespaceModelsFolder)(t,e.namespace,e.modelType);return(0,s.archiveTextures)(r,e.namespace,e.modelType,e.modelId,e.frameTime,e.frameStart,e.interpolate),(0,s.archiveModel)(n,e.modelId,e.enableResourcepackCredits,e.resourcepackCredits),t}))}},292:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.resetResourcepackFormDialogOptions=t.setResourcepackFormDialogOptions=t.getResourcepackFormDialogOptions=t.getDefaultResourcepackFormDialogOptions=void 0;const o=n(r(418));let i;function a(){return{resourcepackName:"blockbench-pack",resourcepackDescription:"",enableResourcepackCredits:!0,resourcepackCredits:'Created with Blockbench [Exported as resourcepack with the "resourcepack_packager" plugin]',resourcepackVersion:Object.values(o.default).reverse()[0].toString(),namespace:"minecraft",modelId:"stone",modelType:"block",enableAnimation:!0,frameTime:1,frameStart:0,interpolate:!1}}t.getDefaultResourcepackFormDialogOptions=a,t.getResourcepackFormDialogOptions=function(){return i||(i=a()),i},t.setResourcepackFormDialogOptions=function(e){i=e},t.resetResourcepackFormDialogOptions=function(){i=void 0}},352:function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function s(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.saveArchive=t.archiveModel=t.archiveTextures=t.archiveManifest=t.getNamespaceTexturesFolder=t.getNamespaceModelsFolder=t.getNamespaceAssetsFolder=void 0;const o=r(811),i=r(10),a=r(723);function s(e,t){var r;return null===(r=e.folder("assets"))||void 0===r?void 0:r.folder(t)}t.getNamespaceAssetsFolder=s,t.getNamespaceModelsFolder=function(e,t,r){var n,o;return null===(o=null===(n=s(e,t))||void 0===n?void 0:n.folder("models"))||void 0===o?void 0:o.folder(r)},t.getNamespaceTexturesFolder=function(e,t,r){var n,o;return null===(o=null===(n=s(e,t))||void 0===n?void 0:n.folder("textures"))||void 0===o?void 0:o.folder(r)},t.archiveManifest=function(e,t,r){e.file("pack.mcmeta",autoStringify((0,o.buildManifest)(t,r)))},t.archiveTextures=function(e,t,r,n,s,c,u){const l=e.folder(n);Texture.all.forEach((e=>{const f=`${(0,a.hardObtainProperty)(e,"name")}.png`;if(e.frameCount&&e.frameCount>1){let t=(0,i.createIncrementalArray)(e.frameCount);t=(0,i.cutAndSwapArray)(t,c),null==l||l.file(`${f}.mcmeta`,autoStringify((0,o.createTextureAnimation)(s,t,u)))}(0,a.hardDefineProperty)(e,"folder",`${r}/${n}`),(0,a.hardDefineProperty)(e,"namespace",t),null==l||l.file(f,e.getBase64(),{base64:!0})}))},t.archiveModel=function(e,t,r=!1,n=""){null==e||e.file(`${t}.json`,autoStringify((0,o.compileJavaBlockCodec)(r,n)))},t.saveArchive=function(e,t){return e.generateAsync({type:"blob"}).then((e=>n(this,void 0,void 0,(function*(){Blockbench.export({type:"Zip Archive",extensions:["zip"],name:t,content:e,savetype:"zip"})}))))}},10:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.cutAndSwapArray=t.createIncrementalArray=void 0,t.createIncrementalArray=function(e){return[...[...Array(e)].keys()]},t.cutAndSwapArray=function(e,t){return[...e.slice(t,e.length),...e.slice(0,t)]}},811:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.createTextureAnimation=t.compileJavaBlockCodec=t.buildManifest=t.obtainBase64PackIcon=void 0;const o=n(r(932));t.obtainBase64PackIcon=function(){return new Promise(((e,t)=>{Screencam.cleanCanvas({width:100,height:100},(r=>{const n=(0,o.default)(r);n||t(new Error("unable to parse screenshot data url")),e(n.data)}))}))},t.buildManifest=function(e,t){return{pack:{description:e,pack_format:t}}},t.compileJavaBlockCodec=function(e=!1,t=""){const r=Codecs.java_block.compile({raw:!0});return r.credit=e?t:"",r},t.createTextureAnimation=function(e,t,r){return{animation:{frametime:e,frames:t,interpolate:r}}}},723:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.hardObtainProperty=t.hardDefineProperty=void 0,t.hardDefineProperty=function(e,t,r){Object.defineProperty(e,t,{value:r,writable:!0,configurable:!0})},t.hardObtainProperty=function(e,t){var r;return null===(r=Object.entries(e).find((([e])=>e===t)))||void 0===r?void 0:r[1]}},504:function(e,t){var r,n,o;n=[],void 0===(o="function"==typeof(r=function(){"use strict";function e(t){return e.regex.test((t||"").trim())}return e.regex=/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i,e})?r.apply(t,n):r)||(e.exports=o)},583:e=>{"use strict";e.exports=JSZip}},t={};(function r(n){var o=t[n];if(void 0!==o)return o.exports;var i=t[n]={exports:{}};return e[n].call(i.exports,i,i.exports,r),i.exports})(607)})();